我们的项目是一个分布式的项目，每一个模块都需要鉴权，就是判断用户是不是已经登录了，这些信息是不是属于用户的。



而为了方便，我们进行了统一的认证， 就是我们在一个地方做认证就可以了。



流程和下面一样，我以下单为例，

![[bc9135fe-52f0-4724-9b52-d5dd24b1b93e.svg]]





这里最方便的地方就是我们使用了sa-token来进行解析，原先的方案是通过一个过滤器拦截到http请求，然后再通过jwtUtils解析出来放到UserContext里面。这个部分还要放到starter中，每一个都要写到



这里的sa-token我们将redis当成session了，将登录信息存储到redis中，并且把sa-token返回给浏览器，浏览器将token存储到cookie中，或者是localStorage中。



在下一次访问其他页面的时候把这个 token 带回来， 然后就可以在后端通过 satoken 进行登录校验了。



我们没有让前端传 userId 过来，因为前端的参数是可以被篡改的，不可信的，所以我们不能信他传过来的用户信息。所以我们需要自己去 SaToken 中获取。



在登录的时候调用StpUtil.login()方法，



在获取信息的时候可以调用StpUtil.getLoginId()方法，因为我们在登录的时候就是把用户 id 当作 loginId 存进去的。



可以的话，自己跟一遍sa-token的StpUtil.getSession().set()方法，跟到最后你会看到，在保存的过程中，他是有一个dao接口，在咱们会引入了sa-token的redis实现以后，我们是可以找到这个dao的redis实现的。

