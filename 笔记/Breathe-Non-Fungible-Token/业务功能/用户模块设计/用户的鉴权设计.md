因为我们的项目中肯定会有管理者，画家，普通人，等角色的限制，每个角色能能够访问某些资源的权限是不同的，所以我们就使用rbac的思想来解决问题，因为额不需要复杂的权限变动和角色生成，所以并没有整体实现rbac模型，只是实现了相关的获取接口。





我们根据用户的状态/角色分成了以下几种：

1、未登录用户

2、未实名认证用户

3、已实名认证用户

4、管理员用户

5、已被冻结用户

权限的具体控制管理如下：

1、未登录用户

+ 可以查看商品
+ 无法查看个人信息
+ 不能下单

2、未实名认证用户

+ 可以查看商品
+ 可以查看/操作个人信息
+ 不能下单

3、已实名认证用户

+ 可以下单
+ 不能管理商品

4、管理员用户

+ 啥都能干
+ 管理商品

5、已被冻结用户

+ 不能下单

基于以上规则，我们在项目中定义了权限和角色两个维度的信息用户做权限管控：



![[747c35a5-2e13-45bb-9b1b-6cc6d26a056f.png]]



这里是每个用户的角色和权限的赋予接口，真正在判断的时候还是网关做了一层判断。



![[28c9eca2-3f86-4fdc-acca-c35ebee610b7.png]]



看这个过滤器，

在SaRouter.match(路径, r -> StpUtil.checkRole/checkPermission/checkPermissionOr())接口中，就是实现了角色和权限的校验，check的时候会调用我们上方实现的两个接口，然后来对我们传入的角色和权限进行一个判断

