我们的库存扣减是基于redis + 数据库的，先在redis中做预扣减，然后再在数据库中做扣减。



但是我们有一种方案是没用MQ的，而是在数据库中用了InventoryHint，它可以帮我们抗高并发的热点更新



![[265687f1-63ba-4884-bc30-789f2f98666f.png]]



以上是整体系统的交互图，下面是更加详细的系统时序图。

![[cb6a9485-aa3c-4daf-b3d2-c486f41e1ddb.svg]]

