责任链模式（Chain of Responsibility Pattern）是一种行为设计模式，可以通过将一系列处理器按顺序链接起来，使得每个处理器都有机会处理请求，从而实现请求的传递和处理

在我们的项目中，我们通过责任链模式实现订单下单时的各种前置校验。

先定义一个接口，其中定义两个方法：

```java
package com.example.demo.designpattern.chain;  
  
/**  
 * @author: breathe  
 * @createTime: 2025-08-19  
 */public interface OrderCreateValidator {  
  
    void setNext(OrderCreateValidator nextValidator);  
  
    void validate(OrderCreateRequest request);  
}
```

setNext用于设置下一个处理器，validate 方法用于做请求检验。

然后实现一个基础校验器。

```java
package com.example.demo.designpattern.chain;  
  
/**  
 * @author: breathe  
 * @createTime: 2025-08-19  
 */public abstract class BaseOrderCreateValidator implements OrderCreateValidator{  
  
    protected OrderCreateValidator nextValidator;  
  
    @Override  
    public void setNext(OrderCreateValidator nextValidator) {  
        this.nextValidator = nextValidator;  
    }  
  
    @Override  
    public void validate(OrderCreateRequest request) {  
        this.doValidate(request);  
  
        if (nextValidator != null) {  
            nextValidator.validate(request);  
        }  
    }  
    protected abstract void doValidate(OrderCreateRequest request);  
}
```

将内些设置逻辑设置好， 之后只用实现doValidate就行。

分别实现了商品、用户以及库存的校验，每一个校验器只关心自己要校验的数据即可，如果有需要更多的东西需要校验，可以扩展出更多的校验器即可。

接下来就是把他们编排到一起：

```java
package com.example.demo.designpattern.chain;  
  
import org.springframework.beans.factory.annotation.Autowired;  
import org.springframework.context.annotation.Bean;  
import org.springframework.context.annotation.Configuration;  
  
/**  
 * @author: breathe  
 * @createTime: 2025-08-19  
 */@Configuration  
public class OrderCreateValidatorConfig {  
  
    @Autowired  
    private UserValidator userValidator;  
  
    @Autowired  
    private StockValidator stockValidator;  
  
    @Autowired  
    private GoodsValidator goodsValidator;  
  
    @Bean  
    public OrderCreateValidator orderCreateValidator() {  
        userValidator.setNext(stockValidator);  
        stockValidator.setNext(goodsValidator);  
        return userValidator;  
    }  
}
```

通过定义一个OrderCreateValidator的 bean，把他们连在一起，即先进行用户的校验、其次进行商品和库存的校验。

接下来，就可以在我们想要做校验的地方调用orderValidatorChain.validate进行校验了：

```java
package com.example.demo.designpattern.chain;  
  
import org.junit.jupiter.api.Test;  
import org.springframework.beans.factory.annotation.Autowired;  
  
/**  
 * @author: breathe  
 * @createTime: 2025-08-19  
 */public class ChainTest {  
  
    @Autowired  
    private OrderCreateValidator orderValidatorChain;  
  
    @Test  
    public void testOne() {  
        System.out.println("====start====");  
        long start = System.currentTimeMillis();  
        orderValidatorChain.validate(new OrderCreateRequest());  
        long end = System.currentTimeMillis();  
        System.out.println("耗时: " + (end - start) + " ms");  
        System.out.println("====end====");  
    }  
}
```

