# 背景
层域实验本质是一个层域流量管理方式，在不同的方式有不同的落地实现。
业界平台也没有一个非常标准的实现
**字节Libra** 基于父子实验实现了层域流量管理，Horizon基于关联实验实现层域，本质上是定义层，实验，实验组关系上的一个抉择。Arena保留了这种层级关系，所以我们需要在此基础上进一步对层域实验做出技术选型。
# 名词解释
[[实验平台相关概念]]

# 技术选型
Arena采用父子or贯穿结构落地层域实验，存在以下几个考虑点

| 考虑点                 | 父子实验                                                                                   | 贯穿实验                                                                                                                                          | 对比结论       |
| ------------------- | -------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- | ---------- |
| **层域架构图**<br>首页推荐为例 | ![[Pasted image 20251017144202.png]]                                                   | ![[Pasted image 20251017144220.png]]                                                                                                          | 持平         |
| **分流实验**            | 支持                                                                                     | 支持                                                                                                                                            | 持平         |
| **长期空白实验**          | 父子实验可以基于父实验灵活控制流量是否进入子实验，基于实验组粒度控制层域流量的方式可以支持域内效果和域外效果的对比                              | 贯穿实验可以基于实验绑定多个层灵活控制流量是否进入隔离域，但是由于平台为保障实验科学性，会限制跨实验对比效果，因此基于实验粒度控制层域流量的方式无法做到域内效果和域外效果的对比，因此长期空白能力只能通过工程代码手动实现父子实验方案，类似贯穿实验-推荐首页场景右侧通过代码实现的贯穿层 | 父子更优       |
| **业务打散**            | 可以复用Arena已有实验打散能力直接通过打散父实验的方式实现场景整体打散，**无额外开发成本，用户理解成本较低**                             | 需要增加业务维度打散因子实现业务打散能力，**有额外开发和用户理解成本**                                                                                                         | 父子更优，实现更简单 |
| **运维成本**            | 父子实验方式可以将实验关系全部通过实验平台配置来完成，**整个层域结构在实验平台清晰可见**，运维成本低                                   | 贯穿实现方式在空白组场景下**需要工程实现父子逻辑**（搜推空白组现状），会提高工程的开发和运维成本（和上一点一样）                                                                                    | 父子更优       |
| **创建层域实验**          | 一般是先创建好子层，然后创建父实验并将所有子层绑定到父实验的某个实验组上，然后在各个子层上逐步新建常规实验，当有新的实验和层加入时，手动将层绑定到父实验的分组，存在一定成本 | 一般是先创建好各个层，然后创建贯穿实验，绑定到各个层上，然后在各个层上逐步新建常规实验，当有新实验和层加入时，手动在贯穿实验上绑定新层，存在一定成本                                                                    | 持平         |
| **下线层域实验**          | 需要先下线子实验，才能下线父实验，操作成本高                                                                 | 可以直接下线贯穿实验，操作成本低                                                                                                                              | 贯穿更优       |

# Question
什么是域？